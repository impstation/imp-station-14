- type: nameIdentifierGroup
  id: Anomalite
  prefix: ANOM
  minValue: 0
  maxValue: 999

- type: entity
  parent: BaseAnomalyCore
  id: AnomaliteCore
  name: anomalite core
  description: It's empty.
  components:
  - type: AnomalyCore
    timeToDecay: 1
    startPrice: 10
    endPrice: 10

# Base Anomalite
- type: entity
  parent: [ BaseMob, MobDamageable, MobPolymorphable, MobAtmosExposed, MobCombat, MobBloodstream ] # SimpleSpaceMobBase has AI, so we need to remake it from scratch.
  id: BaseAnomalite
  abstract: true
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    noRot: true
    drawdepth: Mobs
    scale: 1, 1
  - type: MeleeWeapon 
    damage:
      types:
        Blunt: 0 # this should be a custom type and value for each anomaly type.
    angle: 0
    animation: WeaponArcBite
  - type: NpcFactionMember
    factions:
    - SimpleNeutral
  - type: Body
    prototype: Animal
  - type: Climbing
  - type: NameIdentifier
    group: Anomalite
  # stuff below this is custom, not from SimpleSpaceMobBase
  - type: GhostTakeoverAvailable
  - type: Tag
    tags:
    - VimPilot
    - DoorBumpOpener
    - AnomalyHost # this is potentially really funny. if not, or if it causes problems, we can remove it.
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.35
        density: 75
        restitution: 0.0
        mask:
        - CrateMask # this is so they can fly over tables and through plastic flaps
        layer:
        - MobLayer
  - type: Bloodstream
    bloodReagent: Anomalium
  - type: InteractionPopup
    successChance: 0.1
    interactSuccessString: petting-success-apid # todo: custom
    interactFailureString: petting-failure-apid # todo: custom
    interactSuccessSpawn: EffectHearts
    interactSuccessSound:
      path: /Audio/Animals/mouse_squeak.ogg # this should be unique per-type.
    interactFailureSound:
      path: /Audio/Effects/tesla_consume.ogg # this should be unique per-type.
  - type: StatusEffects
    allowed:
    - Stun
    - KnockedDown
    - SlowedDown
    - Stutter
    - Electrocution
    - ForcedSleep
    - TemporaryBlindness
    - Pacified
    - StaminaModifier
    - Flashed
    - RadiationProtection
    - Drowsiness
    - Adrenaline
  - type: Anomaly
    cannotSupercrit: true
    deleteEntity: false
    maxPointsPerSecond: 10
    corePrototype: AnomaliteCore
    healthChangePerSecond: 0.0
    decayhreshold: 9999.0
    growthThreshold: 9999.0
    minContituty: 0.0
    maxContituty: 0.0
  # apid-type always weightless movement
  - type: MovementAlwaysTouching
  - type: MovementIgnoreGravity
    gravityState: true
  - type: Physics
    bodyStatus: InAir
  - type: CanMoveInAir
  - type: FloatingVisuals # no idea why this isn't working.
  - type: MovementSpeedModifier
    weightlessFriction: 1
    weightlessFrictionNoInput: 2 # so they can actually stop moving
    weightlessAcceleration: 1.5
  - type: NoSlip

- type: entity
  parent: [ BaseAnomalite, MobFlammable ]
  id: BaseAnomaliteFlammable
  abstract: true
  categories: [ HideSpawnMenu ]

# Anomalites:
# Pyroclastic
- type: entity
  parent: [ BaseAnomalite ]
  id: MobAnomalitePyroclastic
  name: pyroclastic anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/fire.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/fire.rsi
    state: anom
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Heat: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#E25822"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionPyroclastic
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank

# Gravity
- type: entity
  parent: [ BaseAnomaliteFlammable ]
  id: MobAnomaliteGravity
  name: gravity anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/grav.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/grav.rsi
    state: anom
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Blunt: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#1e070e"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionGravity
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank

# Ice
- type: entity
  parent: [ BaseAnomaliteFlammable ]
  id: MobAnomaliteIce
  name: ice anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/ice.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/ice.rsi
    state: anom
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Cold: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#befaff"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionIce
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank

# Flesh
- type: entity
  parent: [ BaseAnomaliteFlammable ]
  id: MobAnomaliteFlesh
  name: flesh anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/flesh.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/flesh.rsi
    state: anom
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Slashing: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#cb5b7e"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionFlesh
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank

# Rock
- type: entity
  parent: [ BaseAnomaliteFlammable ]
  id: MobAnomaliteRock
  name: rock anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/rock.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/rock.rsi
    state: anom
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Blunt: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#5ca8cb"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionRock
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank

# Reagent
- type: entity
  parent: [ BaseAnomaliteFlammable ]
  id: MobAnomaliteLiquid
  name: liquid anomalite
  description: A strange little sprite, born from the leftover energies of an anomaly core.
  components:
  - type: Icon
    sprite: _Impstation/Mobs/Anomalites/reagent.rsi
    state: anom
  - type: Sprite
    sprite: _Impstation/Mobs/Anomalites/reagent.rsi
    layers:
    - state: anom
      map: ["enum.AnomalyVisualLayers.Base"]
    - state: pulse
      map: ["enum.AnomalyVisualLayers.Animated"]
      visible: false
    noRot: true
    drawdepth: Mobs
  - type: MeleeWeapon
    damage:
      types:
        Poison: 5
    angle: 0
    animation: WeaponArcBite
  - type: PointLight
    radius: 2
    energy: 1
    softness: 10
    color: "#ffffff"
  # Anomaly functionality
  - type: InnerBodyAnomaly
    injectionProto: AnomalyInjectionLiquid
    fallbackSprite:
      sprite: _Impstation/Mobs/Anomalites/anomalite.rsi
      state: blank
  - type: SolutionContainerManager
    solutions:
      anomaly:
        maxVol: 1500
  - type: MeleeChemicalInjector
    solution: anomaly
    transferAmount: 6
  - type: RandomSprite
    selected:
      enum.AnomalyVisualLayers.Base:
        anom: "#ffffff"
      enum.AnomalyVisualLayers.Animated:
        pulse: "#ffffff"
  - type: SolutionScanner # i think it's fun for them to be able to scan their solutions


